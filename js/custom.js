function owoBig(){let t=1,e="",n=document.createElement("div");n.id="owo-big";let i=document.querySelector("body");i.appendChild(n),document.getElementById("post-comment").addEventListener("DOMNodeInserted",(o=>{if(o.target.classList&&(o.target.classList.value,1)){let l=o.target;l.addEventListener("contextmenu",(t=>t.preventDefault())),l.addEventListener("mouseover",(o=>{"IMG"==o.target.tagName&&t&&(t=0,e=setTimeout((()=>{let t=3*o.path[0].clientHeight,e=3*o.path[0].clientWidth,l=o.x-o.offsetX-(e-o.path[0].clientWidth)/2;l+e>i.clientWidth&&(l-=l+e-i.clientWidth+10),l<0&&(l=10);let s=o.y-o.offsetY;n.style.height=t+"px",n.style.width=e+"px",n.style.left=l+"px",n.style.top=s+"px",n.style.display="flex",n.innerHTML=`<img src="${o.target.src}">`}),300))})),l.addEventListener("mouseout",(i=>{n.style.display="none",t=1,clearTimeout(e)}))}}))}function PublicSacrificeDay(){var t=new Array("0403","0404","0405","0406","0414","0512","0707","0807","0814","0909","0918","0930","1025","1213"),e=new Date,n="",i=e.getMonth()+1;return e.getMonth()>9?n+=i:n+="0"+i,e.getDate()>9?n+=e.getDate():n+="0"+e.getDate(),t.indexOf(n)>-1?1:0}function percent(){let t=document.documentElement.scrollTop||window.pageYOffset,e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-document.documentElement.clientHeight,n=Math.round(t/e*100),i=document.querySelector("#go-up");n<=95?(i.childNodes[0].style.display="none",i.childNodes[1].style.display="block",i.childNodes[1].innerHTML=n):(i.childNodes[1].style.display="none",i.childNodes[0].style.display="block")}function tagsBarActive(){var t=window.location.pathname;if("/"==(t=decodeURIComponent(t)))document.querySelector("#tags-bar")&&document.getElementById("首页").classList.add("select");else{if(/\/tags\/.*?\//.test(t)){var e=t.split("/")[2];document.querySelector("#category-bar")&&document.getElementById(e).classList.add("select")}}}function percent(){let t=document.documentElement.scrollTop||window.pageYOffset,e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-document.documentElement.clientHeight,n=Math.round(t/e*100);n<=99||(n=99),document.querySelector("#percent").innerHTML=n}function postAddToc(){let t=document.querySelector("#post>#article-container.post-content"),e=document.getElementById("card-toc");if(t&&e){let t=e.getElementsByClassName("toc-number"),n=e.getElementsByClassName("toc-link");for(let e=0;e<n.length;e++)document.getElementById(decodeURIComponent(n[e].attributes.href.value).slice(1)).dataset.toc=t[e].innerText}}document.getElementById("post-comment")&&owoBig(),PublicSacrificeDay()&&document.getElementsByTagName("html")[0].setAttribute("style","filter:gray !important;filter:grayscale(100%);-webkit-filter:grayscale(100%);-moz-filter:grayscale(100%);-ms-filter:grayscale(100%);-o-filter:grayscale(100%);"),window.onscroll=percent,tagsBarActive(),window.onscroll=percent,document.getElementById("page-name").innerText=document.title.split(" | 幽香乐容")[0],postAddToc();var percentFlag=!1;function essayScroll(){const t=(document.documentElement.scrollTop||window.pageYOffset)%document.documentElement.clientHeight;result<=99||(result=99),!percentFlag&&t+100>=document.documentElement.clientHeight&&document.querySelector("#waterfall")?setTimeout((()=>{waterfall("#waterfall")}),500):setTimeout((()=>{document.querySelector("#waterfall")&&waterfall("#waterfall")}),500);const e=window.scrollY+document.documentElement.clientHeight;let n=document.getElementById("post-comment")||document.getElementById("footer");(n.offsetTop+n.offsetHeight/2<e||90<result)&&(percentFlag=!0)}function replaceAll(t,e,n){return t.split(e).join(n)}var yxlr={diffDate:function(t,e=!1){const n=new Date,i=new Date(t),o=n.getTime()-i.getTime(),l=36e5,s=24*l;let a;if(e){const t=o/s,e=o/l,n=o/6e4;a=o/2592e6>=1?i.toLocaleDateString().replace(/\//g,"-"):t>=1?parseInt(t)+" "+GLOBAL_CONFIG.date_suffix.day:e>=1?parseInt(e)+" "+GLOBAL_CONFIG.date_suffix.hour:n>=1?parseInt(n)+" "+GLOBAL_CONFIG.date_suffix.min:GLOBAL_CONFIG.date_suffix.just}else a=parseInt(o/s);return a},changeTimeInEssay:function(){document.querySelector("#bber")&&document.querySelectorAll("#bber time").forEach((function(t){var e=t,n=e.getAttribute("datetime");e.innerText=yxlr.diffDate(n,!0),e.style.display="inline"}))},reflashEssayWaterFall:function(){document.querySelector("#waterfall")&&setTimeout((function(){waterfall("#waterfall"),document.getElementById("waterfall").classList.add("show")}),500)},commentText:function(t){"undefined"!=t&&"null"!=t||(t="好棒！");var e=document.getElementsByClassName("el-textarea__inner")[0],n=document.createEvent("HTMLEvents");if(e){n.initEvent("input",!0,!0);var i=replaceAll(t,"\n","\n> ");e.value="> "+i+"\n\n",e.dispatchEvent(n);var o=document.querySelector("#post-comment").offsetTop;window.scrollTo(0,o-80),e.focus(),e.setSelectionRange(-1,-1),document.getElementById("comment-tips")&&document.getElementById("comment-tips").classList.add("show")}}};if(yxlr.changeTimeInEssay(),yxlr.reflashEssayWaterFall(),document.querySelector("#bber-talk"))var swiper=new Swiper(".swiper-container",{direction:"vertical",loop:!0,autoplay:{delay:3e3,pauseOnMouseEnter:!0}});function dark(){window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;var t,e,n,i,o=.05,l=document.getElementById("universe"),s=!0,a="226,225,224",c=[];function r(){t=window.innerWidth,e=window.innerHeight,n=.216*t,l.setAttribute("width",t),l.setAttribute("height",e)}function d(){i.clearRect(0,0,t,e);for(var n=c.length,o=0;o<n;o++){var l=c[o];l.move(),l.fadeIn(),l.fadeOut(),l.draw()}}function m(){this.reset=function(){this.giant=u(3),this.comet=!this.giant&&!s&&u(10),this.x=h(0,t-10),this.y=h(0,e),this.r=h(1.1,2.6),this.dx=h(o,6*o)+(this.comet+1-1)*o*h(50,120)+.1,this.dy=-h(o,6*o)-(this.comet+1-1)*o*h(50,120),this.fadingOut=null,this.fadingIn=!0,this.opacity=0,this.opacityTresh=h(.2,1-.4*(this.comet+1-1)),this.do=h(5e-4,.002)+.001*(this.comet+1-1)},this.fadeIn=function(){this.fadingIn&&(this.fadingIn=!(this.opacity>this.opacityTresh),this.opacity+=this.do)},this.fadeOut=function(){this.fadingOut&&(this.fadingOut=!(this.opacity<0),this.opacity-=this.do/2,(this.x>t||this.y<0)&&(this.fadingOut=!1,this.reset()))},this.draw=function(){if(i.beginPath(),this.giant)i.fillStyle="rgba(180,184,240,"+this.opacity+")",i.arc(this.x,this.y,2,0,2*Math.PI,!1);else if(this.comet){i.fillStyle="rgba("+a+","+this.opacity+")",i.arc(this.x,this.y,1.5,0,2*Math.PI,!1);for(var t=0;t<30;t++)i.fillStyle="rgba("+a+","+(this.opacity-this.opacity/20*t)+")",i.rect(this.x-this.dx/4*t,this.y-this.dy/4*t-2,2,2),i.fill()}else i.fillStyle="rgba(226,225,142,"+this.opacity+")",i.rect(this.x,this.y,this.r,this.r);i.closePath(),i.fill()},this.move=function(){this.x+=this.dx,this.y+=this.dy,!1===this.fadingOut&&this.reset(),(this.x>t-t/4||this.y<0)&&(this.fadingOut=!0)},setTimeout((function(){s=!1}),50)}function u(t){return Math.floor(1e3*Math.random())+1<10*t}function h(t,e){return Math.random()*(e-t)+t}r(),window.addEventListener("resize",r,!1),function(){i=l.getContext("2d");for(var t=0;t<n;t++)c[t]=new m,c[t].reset();d()}(),function t(){"dark"==document.getElementsByTagName("html")[0].getAttribute("data-theme")&&d(),window.requestAnimationFrame(t)}()}dark();